<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <link rel="stylesheet" href="./style.css" />
</head>

<body>
    <h1> Javascript Quiz </h1>
    <div id="countdown"></div>
    <div id="quiz-content">
        <div class="quiz-container">
            <div id="quiz"></div>
        </div>
        <button id="previous">Previous Question</button>
        <button id="next">Next Question</button>
        <button id="submit">Submit Quiz</button>
        <div id="results"></div>
    </div>


    <script>

        const quizContainer = document.getElementById('quiz');
        const resultsContainer = document.getElementById('results');
        const submitButton = document.getElementById("submit");
        const previousButton = document.getElementById("previous");
        const nextButton = document.getElementById("next");
        const quizContent = document.getElementById("quiz-content");
        let currentSlide = 0;


      //define questions in array w/ answers
        const myQuestions = [
            {
                question: "Javascript is utilized in ______ development",
                answers: {
                    A: "emotional",
                    B: "web",
                    C: "jet engine"
                },
                correctAnswer: "B"
            },
            {
                question: "Which of these executes code in javascript?",
                answers: {
                    A: "functions",
                    B: "igniters",
                    C: "jumpers"
                },
                correctAnswer: "A"
            },
            {
                question: "Which of the following is a Javascript library?",
                answers: {
                    A: "Jquesey",
                    B: "Qjourney",
                    C: "Jquery",
                },
                correctAnswer: "C"
            }
        ];
            //function to actually display the quiz via slides (active slide visible) and radio buttons
        function buildQuiz() {
            const output = [];
            //function to display each myQuestion array propery
            myQuestions.forEach(function (currentQuestion, questionNumber) {
                const answers = [];
                //display answers for current question
                for (letter in currentQuestion.answers) {
                    answers.push(
                        `<label>
                <input type="radio" name="question${questionNumber}" value="${letter}"/>
                ${letter} : 
                ${currentQuestion.answers[letter]}
            </label>`
                    );
                }
                //display current question
                output.push(
                    `<div class="slide">
        <div class="question"> ${currentQuestion.question} </div>
        <div class="answers"> ${answers.join('')} </div>
        </div>`
                );
            }
            );

            quizContainer.innerHTML = output.join('');
        };

        //function to display results
        function showResults() {
            const answerContainers = quizContainer.querySelectorAll('.answers');

            let numCorrect = 0;

            myQuestions.forEach(function (currentQuestion, questionNumber) {
                const answerContainer = answerContainers[questionNumber];
                const selector = `input[name=question${questionNumber}]:checked`;
                const userAnswer = (answerContainer.querySelector(selector) || {}).value;

                //if correct answer
                if (userAnswer === currentQuestion.correctAnswer) {
                    numCorrect++;

                    //answer color at end of quiz
                    answerContainers[questionNumber].style.color = 'green';
                }
                else {
                    answerContainers[questionNumber].style.color = "red";
                }
            });

            resultsContainer.innerHTML = `${numCorrect} out of ${myQuestions.length}`;
        };

        //function to display active slide
        function showSlide(n) {
            slides[currentSlide].classList.remove('active-slide');
            slides[n].classList.add('active-slide');
            currentSlide = n;
            if (currentSlide === 0) {
                previousButton.style.display = "none";
            }
            else {
                previousButton.style.display = 'inline-block';
            }
            if (currentSlide === slides.length - 1) {
                nextButton.style.display = 'none';
                submitButton.style.display = 'inline-block';
            }
            else {
                nextButton.style.display = 'inline-block';
                submitButton.style.display = 'none';
            }
        };

       

        //call quiz function 
        buildQuiz();

        const slides = document.querySelectorAll(".slide");
        //defined after buildquiz because slide class defined in that function

        showSlide(currentSlide);

        function showNextSlide() {
            showSlide(currentSlide + 1);
        };
        function showPreviousSlide() {
            showSlide(currentSlide - 1)
        };

        //countdown timer
        //set it to 60 seconds
        let timeleft = 60;
        let countdownTimer = setInterval(function () {
            if (timeleft <= 0) {
                clearInterval(countdownTimer);
                //make quiz content div disappear at 0
                quizContent.style.display = "none";
                document.getElementById("countdown").innerHTML = "You ran out of time!";
            } else {
                document.getElementById("countdown").innerHTML = timeleft + " seconds remaining";
            }
            timeleft -= 1;
        }, 1000);

        //eventlisteners for button clicks
        previousButton.addEventListener("click", showPreviousSlide);
        nextButton.addEventListener("click", showNextSlide);
        $(submitButton).on("click", showResults);



    </script>

</body>

</html>